<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>Awesome Korean</title>
    <link rel="stylesheet" href="css/style_main.css">
    <link rel="stylesheet" href="css/style_study.css">
  </head>
  <body>
    <div id="header">
      <a href="home.html"><img src="img/home.svg" alt="home" class="icon"></a>
      <h1>Awesome Korean</h1>
      <a href="Consonants.html"><img src="img/back.svg" alt="back" class="icon"></a>
    </div>
    <div id="content">
      <div id="content_study">
        <a href="" id="button_left" ontouchstart="leftHangul()"><img src="img/left.svg" alt="left" class="icon button_left"></a>
        <div id="study_conVow">ㄱ</div>
        <a href="" id="button_right" ontouchstart="rightHangul()"><img src="img/right.svg" alt="right" class="icon button_right"></a>
      </div>
      <div id="content_message">We can find how our articulator moves when we read each name of consonants slowly.</div>
      <div id="content_button_function">
        <button type="button" class="button" ontouchstart="audioPlay()">Listening</button>
        <button type="button" id="button_writing"class="button" ontouchstart="writingPlay()" disabled="true">Writing</button>
        <button type="button" id="button_hint" class="button" disabled="true">Hint</button>
      </div>
    </div>
    <div id="footer">
      <p>footer</p>
    </div>
  </body>
  <script>
    let lastArray = ["ㄱ", "역", "박", "ㄲ", "밖", "ㅋ", "읔", "엌", "ㄴ", "은", "안", "ㄷ", "귿", "낟", "ㅌ", "읕", "낱", "ㅅ", "옷", "낫", "ㅆ", "났", "ㅈ", "읒", "낮", "ㅊ", "읓", "낯", "ㅎ", "읗", "낳", "ㄹ", "을", "알", "ㅁ", "음", "암", "ㅂ", "읍", "압", "ㅍ", "읖", "앞", "ㅇ", "응", "앙" ];
    let countClick = 0;
    let hangul = document.getElementById("study_conVow");
    let currentSound = null;
    let currentMsg = document.getElementById('content_message')
    let teachingMsg = [
      "We can find how our articulator moves when we read each name of consonants slowly.",
      "Can you feel your throat closed when you pronounce batchim 'ㄱ'? (I'll leave 'batchim' out from now.)",
      "Let's practice another character with 'ㄱ'.",
      "'ㄲ' is same with 'ㄱ'.",
      "Let's see an example with 'ㄲ'. We can see it's totally same with 'ㄱ'.",
      "How about 'ㅋ'?",
      "We can still feel our throat closed like 'ㄱ' and 'ㄲ'.",
      "It means 'ㄱ', 'ㄲ', and 'ㅋ' have totally same movement.",
      "Let's see 'ㄴ'. We can feel another movement.",
      "The tip of our tongue is moving to the top of mouth and behind of upper teeth. And the air is getting out through our nose.",
      "Let's practice another character with 'ㄴ'.",
      "Let's see the 'ㄷ'.",
      "The tongue movement seems like similar with 'ㄴ'.",
      "But the air doesn't out through our nose.",
      "From now, we will see a lot of other same movements with 'ㄷ'.",
      "Isn't it same?",
      "Let's practice another character.",
      "Here's other same movement.",
      "Same.",
      "Yes, it's same.",
      "The movement of double consonant is same with its single consonant.",
      "Same.",
      "Same again.",
      "Isn't it?",
      "Good.",
      "Same again and again.",
      "Awesome!",
      "Great!",
      "Same one more.",
      "Now we can have a question. Why we should use different character even there are lots of same movement? It seems more simple if we use only one batchim.",
      "However, every languages have some words that have same pronunciation but different meaning. It will help us to reduce the number of sound that we should make. Even though it has same sound, we can know enough its different meanings with spelling and the situation.",
      "After a long time, it's different movement.",
      "It has also similar tongue position with 'ㄴ'. But the air is getting out through mouth.",
      "Some Korean learners who are native English speaker, tends to roll up their tongue like [r] sound. But the correct position is behind of upper teeth.",
      "Your lips closed.",
      "And you can feel the sound trembled in your mouth.",
      "And the air is getting out through your mouth.",
      "Your lips closed like 'ㅁ'.",
      "But the sound not trembled.",
      "It's easy.",
      "This is same with 'ㅂ'.",
      "Totally same.",
      "That's right.",
      "Finally, this is the last one.",
      "Your mouth opened and the air getting out through your nose.",
      "Perfect! Now you can read all of hangul. Repeat the lesson several times and practice in the next stage."]

    function leftHangul() {
      fadeOut();
      setTimeout(function() {
        if(countClick - 1 < 0 ) {
          countClick = lastArray.length-1;
        } else {
          countClick = countClick - 1;
        }
        audioPlay();
        hangul.innerHTML = lastArray[countClick];
        currentMsg.innerHTML = teachingMsg[countClick];
      },300);
      setTimeout(fadeIn, 300);
    }
    function rightHangul() {
      fadeOut();
      setTimeout(function() {
        if(countClick + 1 == lastArray.length) {
          countClick = 0;
        } else {
          countClick = countClick + 1;
        }
        audioPlay();
        hangul.innerHTML = lastArray[countClick];
        currentMsg.innerHTML = teachingMsg[countClick];
      }, 300);
      setTimeout(fadeIn, 300);
    }

    // Swipe event for pure Javascript
    let el = document.getElementById('content');
    let touchsurface = el,
        swipedir,
        startX,
        startY,
        distX,
        distY,
        threshold = 150, //required min distance traveled to be considered swipe
        restraint = 100, // maximum distance allowed at the same time in perpendicular direction
        allowedTime = 300, // maximum time allowed to travel that distance
        elapsedTime,
        startTime;

    touchsurface.addEventListener('touchstart', function(e) {
      e.preventDefault()
      let touchobj = e.changedTouches[0]
      swipedir = 'none'
      dist = 0
      startX = touchobj.pageX
      startY = touchobj.pageY
      startTime = new Date().getTime() // record time when finger first makes contact with surface
    }, false)

    touchsurface.addEventListener('touchmove', function(e) {
      e.preventDefault() // prevent scrolling when inside DIV
    }, false)

    touchsurface.addEventListener('touchend', function(e) {
      let touchobj = e.changedTouches[0]
      distX = touchobj.pageX - startX // get horizontal dist traveled by finger while in contact with surface
      distY = touchobj.pageY - startY // get vertical dist traveled by finger while in contact with surface
      elapsedTime = new Date().getTime() - startTime // get time elapsed
      if (elapsedTime <= allowedTime){ // first condition for awipe met
        if (Math.abs(distX) >= threshold && Math.abs(distY) <= restraint){ // 2nd condition for horizontal swipe met
          swipedir = (distX < 0)? 'left' : 'right' // if dist traveled is negative, it indicates left swipe
        }
      }
      if(swipedir == "left") {
        rightHangul();
      } else if(swipedir == "right") {
        leftHangul();
      }
    }, false)

    // Fade event function with pure Javascript
    function fadeIn(){
      hangul.classList.add('show');
      hangul.classList.remove('hide');
    }
    function fadeOut(){
      hangul.classList.add('hide');
      hangul.classList.remove('show');
    }

    // Audio play function
    function audioPlay() {
      if(currentSound) {
        currentSound.pause();
        currentSound.currentTime = 0;
      }
      currentSound = new Audio('audio/vowel/'+lastArray[countClick]+'.mp3');
      currentSound.play()
    }

    touchsurface.addEventListener('touchend', function(e) {
      e.preventDefault();
      hangul.innerHTML = lastArray[countClick];
    }, false)

  </script>
</html>
