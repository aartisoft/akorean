<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>Awesome Korean</title>
    <link rel="stylesheet" href="css/style_main.css">
    <link rel="stylesheet" href="css/style_assembly.css">
  </head>
  <body>
    <div id="header">
      <a href="home.html"><img src="img/home.svg" alt="home" class="icon"></a>
      <h1>Awesome Korean</h1>
      <a href="#"><img src="img/back.svg" alt="back" class="icon"></a>
    </div>
    <div id="content">
      <div id="content_assembly">
        <div id="assembly_consonant_1" ondrop="drop(event)" ondragover="allowDrop(event)">C</div>
        <div id="assembly_vowel_1" ondrop="drop(event)" ondragover="allowDrop(event)">V</div>
      </div>
      <div id="content_message"></div>
      <div id="content_button_conVow">
        <button type="button" class="button" onclick="btn_function('consonant')">Consonant</button>
        <button type="button" class="button" onclick="btn_function('vowel')">Vowel</button>
      </div>
      <div>
        <div id="container_consonant"></div>
        <div id="container_vowel"></div>
      </div>
      <div id="content_button_function">
        <button type="button" class="button">Native's voice</button>
        <button type="button" class="button">My voice</button>
        <button type="button" class="button">Writing</button>
      </div>
    </div>
    <div id="footer">
      <p>footer</p>
    </div>

  </body>
  <script>

  let consonant_array = ["ㄱ", "ㄴ", "ㄷ", "ㄹ", "ㅁ", "ㅂ", "ㅅ", "ㅇ", "ㅈ", "ㅊ", "ㅋ", "ㅌ", "ㅍ", "ㅎ", "ㄲ", "ㄸ", "ㅃ", "ㅆ", "ㅉ"];
  let vowel_array = ["ㅏ", "ㅑ", "ㅓ", "ㅕ", "ㅣ", "ㅐ", "ㅒ", "ㅔ", "ㅖ"];

  //Function to make boxes of consonant and vowels
  function createCharacters(character, num, conVow) {
    let newElement = document.createElement("div");
    newElement.setAttribute("class", conVow);
    newElement.setAttribute("id", conVow+num);
    // newElement.setAttribute("draggable", "true");
    // newElement.setAttribute("ondragstart", "drag(event)");
    newElement.addEventListener("touchstart", touchDrag, false);
    newElement.addEventListener("touchend", touchDrop, false);

    let newCharacterNode = document.createTextNode(character);
    newElement.appendChild(newCharacterNode);
    return newElement;
  }

  let currentDiv = document.getElementById("container_consonant")

  for(let i=0; i<consonant_array.length; i++) {
    let consonant = createCharacters(consonant_array[i], i, "consonant");
    currentDiv.appendChild(consonant);
  }
  for(let i=0; i<vowel_array.length; i++) {
    let vowel = createCharacters(vowel_array[i], i, "vowel");
    currentDiv.appendChild(vowel);
  }

  // Mobile Touch drag and drop
    var lastTouchId = null;
    function touchDrag(ev) {
      ev.preventDefault();
      document.getElementById("content_message").innerHTML = "";
      lastTouchId = ev.target.id;
    }
    function touchDrop(ev) {
      ev.preventDefault();
      let content = document.getElementById(lastTouchId).textContent;

      var changedTouch = ev.changedTouches[0];
      var elem = document.elementFromPoint(changedTouch.clientX, changedTouch.clientY);
      // Check matching if consonant and vowel are placed exactly.
      if(elem.id == "assembly_consonant_1" && consonant_array.includes(content)) {
        document.getElementById("assembly_consonant_1").innerHTML = content;
        document.getElementById("assembly_consonant_1").style.color = 'black';
      } else if(elem.id == "assembly_vowel_1" && vowel_array.includes(content)) {
        document.getElementById("assembly_vowel_1").innerHTML = content;
        document.getElementById("assembly_vowel_1").style.color = 'black';
      } else {
        document.getElementById("content_message").innerHTML = "Consonant and vowel should be placed in each place.";
      }
    }

  //Drag and drop : javascript
  // function drag(ev) {
  //   document.getElementById("content_message").innerHTML = "";
  //   ev.dataTransfer.setData("text", ev.target.id);
  // }
  // function drop(ev) {
  //   ev.preventDefault();
  //   let data = ev.dataTransfer.getData("text");
  //   let content = document.getElementById(data).textContent;
  //   // Check matching if consonant and vowel are placed exactly.
  //   if(ev.target.id == "assembly_consonant_1" && consonant_array.includes(content)) {
  //     document.getElementById("assembly_consonant_1").innerHTML = content;
  //     document.getElementById("assembly_consonant_1").style.color = 'black';
  //   } else if(ev.target.id == "assembly_vowel_1" && vowel_array.includes(content)) {
  //     document.getElementById("assembly_vowel_1").innerHTML = content;
  //     document.getElementById("assembly_vowel_1").style.color = 'black';
  //   } else {
  //     document.getElementById("content_message").innerHTML = "Consonant and vowel should be placed in each place.";
  //   }
  // }
  // function allowDrop(ev) {
  //   //ev.target.style.color = 'blue';
  //   ev.preventDefault();
  // }

  //Button Function
  let btn_function = function(conVow) {
    if(conVow == "consonant") {
      for(i=0; i<consonant_array.length; i++) {
        document.getElementById("consonant"+i).style.display = "initial";
      }
      for(i=0; i<vowel_array.length; i++) {
        document.getElementById("vowel"+i).style.display = "none";
      }
    } else if(conVow == "vowel") {
      for(i=0; i<consonant_array.length; i++) {
        document.getElementById("consonant"+i).style.display = "none";
      }
      for(i=0; i<vowel_array.length; i++) {
        document.getElementById("vowel"+i).style.display = "initial";
      }
    }
  }
  </script>
</html>
