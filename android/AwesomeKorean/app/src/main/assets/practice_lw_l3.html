<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>Awesome Korean</title>
    <link rel="stylesheet" href="css/style_main.css">
    <link rel="stylesheet" href="css/style_practice_lw.css">
  </head>
  <body>
    <div class="page">

      <div class="page__header">
        <a href="home.html"><img src="img/home.svg" alt="home" class="page__header__icon"></a>
        <h1>Awesome Korean</h1>
        <a href="practice_lw_menu.html"><img src="img/back.svg" alt="back" class="page__header__icon"></a>
      </div>

      <div class="page__content">
        <div>
          <input class="page__content__answer__l3" id="answer" type="text" name="answer">
        </div>
        <div class="page__content__messagelw" id="message"></div>
        <div class="page__content__messagelw__l3">Listen and write correct word into the box!</div>
        <div class="page__content__3buttons">
          <button type="button" class="button" id="repeatBtn" onclick="btn_repeat()">Repeat</button>
          <button type="button" class="button" id="answerBtn" onclick="btn_submit()">Submit</button>
          <button type="button" class="button" id="nextBtn" onclick="btn_next()" disabled>Next</button>
        </div>
        <div class="page__content__result" id="result">
          <div class="page__content__result__head">Score</div>
          <div class="page__content__result__score" id="score"></div>
          <div class="page__content__result__comment" id="comment"></div>
          <div class="page__content__result__playAgain">
            <a href="practice_lw_l3.html">play again</a>
          </div>
        </div>
      </div>

      <div class="page__footer">
        <p>footer</p>
      </div>

    </div>
  </body>

  <script>
  let words = ["사과", "바나나", "수박", "딸기"];
  let currentSound = null;
  let currentProblemNo = 1;
  let message = document.getElementById('message');
  let correct_answer_no = 0;
  let user_answer = document.getElementById('answer');

  // let autoAudio = document.getElementById('playAudio')
  // autoAudio.setAttribute("src",'audio/ass/'+uniResult[currentProblemNo]+'.mp3');

  function audioPlay() {
    console.log("정답:"+words[currentProblemNo]);
    currentSound = new Audio('audio/words/'+words[currentProblemNo]+'.mp3');
    currentSound.play();
  }

  function btn_repeat() {
    currentSound.play();
  }

  function btn_submit() {
    let correct_answer = words[currentProblemNo];
    document.getElementById("answerBtn").disabled = true;
    document.getElementById("nextBtn").disabled = false;

    if(user_answer.value == correct_answer) {
      message.innerHTML = "Correct answer!"
      correct_answer_no += 1;
    } else {
      message.innerHTML = "Wrong answer! The answer is... : " + correct_answer;
    }
  }

  function btn_next() {
    document.getElementById("answerBtn").disabled = false;
    document.getElementById("nextBtn").disabled = true;
    user_answer.value = "";
    message.innerHTML = "";
    currentProblemNo += 1;
    audioPlay();

    // when user solved all problems...
    if(currentProblemNo > 10) {
      result.style.display = "grid";
      document.getElementById("repeatBtn").disabled = true;
      document.getElementById("answerBtn").disabled = true;
      document.getElementById("nextBtn").disabled = true;
      if(correct_answer_no >= 8) {
        score.innerHTML = correct_answer_no +"/10";
        comment.innerHTML = "Awesome!"
      } else if(correct_answer_no >= 5) {
        score.innerHTML = correct_answer_no +"/10";
        comment.innerHTML = "Good!"
      } else {
        score.innerHTML = correct_answer_no +"/10";
        comment.innerHTML = "You can do it!"
      }
    } else {
      quiz();
      audioPlay();
    }
  }

  // Mix the array of words.
  quiz();

  function quiz() {

    for (let i = 0; i < words.length; i++) {
      let rnum = Math.floor(Math.random()*words.length);
      let temp = words[i];
      words[i] = words[rnum];
      words[rnum] = temp;
    }
    audioPlay();
  }
  </script>
</html>
